<!doctype html>
<html>
<head>
   <title>WebShop-SPA</title>
   <link rel="stylesheet" type="text/css" href="css/shop.css">
   <link rel="stylesheet" type="text/css" href="css/shoppingCartContentTable.css">
   <link rel="stylesheet" type="text/css" href="css/pictureOverlay.css">

   <script type="text/javascript" src="lib/jquery-3.2.1.min.js" charset="UTF-8"></script>
   <script type="text/javascript" src="lib/jquery.uriAnchor.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/RequireMock.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/NamespaceUtils.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Promise.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Topics.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/bus/Bus.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Language.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Context.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ResourceProvider.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/AbstractContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/JsonContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/HtmlContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/LanguageDependentTexts.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ShoppingCart.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/AbstractLanguageDependentComponent.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/AbstractHideableLanguageDependentComponent.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/Tab.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/UiStateSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/UiStatePublisher.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/VisibleTabSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/LanguageSelector.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/ProductTableGenerator.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/Actions.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/PictureOverlay.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/LanguageDependentTextSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/LanguageDependentTextInProductTableSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/ShoppingCartButtonTextSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/ProductConfig.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/TableHeaders.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/CartController.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/TableGenerator.js" charset="UTF-8"></script>
   
   <script>
      var baseAddress            = window.location.protocol + '//' + window.location.host + '/';
      var supportedLanguages     = [shop.Language.DE, shop.Language.EN];
      var products               = ['pflanzen', 'zubehoer'];
      var configContentLoader    = new shop.configuration.JsonContentLoader(baseAddress + 'configuration', supportedLanguages);
      var htmlContentLoader      = new shop.configuration.HtmlContentLoader(baseAddress + 'templates', supportedLanguages);
      var languageDependentTexts = new shop.LanguageDependentTexts(baseAddress + 'configuration');
      
      htmlContentLoader.load(['start', 'pflanzen', 'zubehoer', 'versandbedingungen', 'impressum', 'warenkorb', 'pictureOverlay']);
      configContentLoader.load(products);
      languageDependentTexts.load();
      
      $(document).ready(function() {
         new shop.ShoppingCart();
         
         new shop.ui.LanguageDependentTextSetter('#shop > #header #start',           'menu.startButton' );
         new shop.ui.LanguageDependentTextSetter('#shop > #header #plants',          'menu.plantsButton' );
         new shop.ui.LanguageDependentTextSetter('#shop > #header #accessories',     'menu.accessoriesButton' );
         new shop.ui.LanguageDependentTextSetter('#shop > #header #shipping',        'menu.shippingButton' );
         new shop.ui.LanguageDependentTextSetter('#shop > #header #companyDetails',  'menu.companyDetailsButton' );
         new shop.ui.ShoppingCartButtonTextSetter('#shop > #header #shoppingCart',    'menu.shoppingCartButton' );
         
         new shop.ui.VisibleTabSetter('#shop > #header #start',            'start');
         new shop.ui.VisibleTabSetter('#shop > #header #plants',           'plants');
         new shop.ui.VisibleTabSetter('#shop > #header #accessories',      'accessories');
         new shop.ui.VisibleTabSetter('#shop > #header #shipping',         'shipping');
         new shop.ui.VisibleTabSetter('#shop > #header #companyDetails',   'companyDetails');
         new shop.ui.VisibleTabSetter('#shop > #header #shoppingCart',     'shoppingCart');
         
         var startTabConfig = {
            tabId: 'start',
            selector: '#shop > #content > #start',
            configName: undefined,
            contentTemplateName: 'start',
            languages: supportedLanguages
         };
         
         var startTab = new shop.ui.Tab(startTabConfig);
         
         var plantTabConfig = {
            tabId: 'plants',
            selector: '#shop > #content > #plants',
            configName: 'pflanzen',
            contentTemplateName: 'pflanzen',
            languages: supportedLanguages
         };
         
         var plantTab = new shop.ui.Tab(plantTabConfig);
         
         var accessoriesTabConfig = {
            tabId: 'accessories',
            selector: '#shop > #content > #accessories',
            configName: 'zubehoer',
            contentTemplateName: 'zubehoer',
            languages: supportedLanguages
         };
         
         var accessoriesTab = new shop.ui.Tab(accessoriesTabConfig);
         
         var shippingTabConfig = {
            tabId: 'shipping',
            selector: '#shop > #content > #shipping',
            configName: undefined,
            contentTemplateName: 'versandbedingungen',
            languages: supportedLanguages
         };
         
         var shippingTab = new shop.ui.Tab(shippingTabConfig);
         
         var companyDetailsTabConfig = {
            tabId: 'companyDetails',
            selector: '#shop > #content > #companyDetails',
            configName: undefined,
            contentTemplateName: 'impressum',
            languages: supportedLanguages
         };
         
         var companyDetailsTab = new shop.ui.Tab(companyDetailsTabConfig);
         
         var shoppingCartTabConfig = {
            tabId: 'shoppingCart',
            selector: '#shop > #content > #shoppingCart',
            configName: undefined,
            contentTemplateName: 'warenkorb',
            languages: supportedLanguages
         };
         
         var shoppingCartTab = new shop.ui.Tab(shoppingCartTabConfig);
         
         var cartController = new shop.ui.shoppingCart.CartController(products);
         shoppingCartTab.onTabContentChanged(cartController.onTabContentChangedCallback);
         
         var setter = new shop.ui.LanguageDependentTextInProductTableSetter();
         plantTab.onTabContentChanged(setter.onTabContentChangedCallback);
         accessoriesTab.onTabContentChanged(setter.onTabContentChangedCallback);
         
         var pictureOverlayConfig = {
            selector: '#shop > #picture',
            contentTemplateName: 'pictureOverlay',
            languages: supportedLanguages
         };
         
         new shop.ui.PictureOverlay(pictureOverlayConfig);
         
         new shop.ui.LanguageSelector(function() { return $('#shop > #header #languageSelector'); });
         
         var uiStatePublisherConfig = {
            supportedTabs:       ['start', 'plants', 'accessories', 'shipping', 'companyDetails', 'shoppingCart'],
            supportedLanguages:  supportedLanguages,
            defaultTab:          'start',
            defaultLanguage:     shop.Language.DE
         };
         var uiStatePublisher = new shop.ui.UiStatePublisher(uiStatePublisherConfig);
         new shop.ui.UiStateSetter($.uriAnchor.setAnchor);
         
         var onHashChange = function onHashChange() {
            var map = $.uriAnchor.makeAnchorMap();
            uiStatePublisher.setNewState(map);
         };
         
         $(window).bind( 'hashchange', onHashChange ).trigger( 'hashchange' );
      });
   </script>
</head>

<body>
<div id="shop">

   <div id="header">
      <table>
         <tr class="firstRow">
            <td rowspan="2" class="leftColumn">
               <img src="/images/logo.svg">
            </td>
            <td class="centerColumn">
               <h1>Orchideenvermehrung Ederer Webshop</h1>
            </td>
            <td class="rightColumn">
               <button id="languageSelector"></button> 
            </td>
         </tr>
         <tr class="secondRow">
            <td class="centerColumn">
               <button id="start"></button> 
               <button id="plants"></button> 
               <button id="accessories"></button> 
               <button id="shipping"></button> 
               <button id="companyDetails"></button> 
            </td>
            <td class="rightColumn">
               <button id="shoppingCart"></button> 
            </td>
         </tr>
      </table>
   </div>

   <div id="content">
      <div id="start"></div>
      <div id="plants"></div>
      <div id="accessories"></div>
      <div id="shipping"></div>
      <div id="companyDetails"></div>
      <div id="shoppingCart"></div>
   </div>
   
   <div id="picture"></div>

   <div id="footer">
      <div id="author">written by Thomas Ederer</div>
   </div>
</div>
</body>
</html>  