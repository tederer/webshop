<!doctype html>
<html>
<head>
   <title>WebShop-SPA</title>
   <link rel="stylesheet" type="text/css" href="css/shop.css">

   <script type="text/javascript" src="lib/jquery-3.2.1.min.js" charset="UTF-8"></script>
   <script type="text/javascript" src="lib/jquery.uriAnchor.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/RequireMock.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/NamespaceUtils.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Promise.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Topics.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/bus/Bus.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Context.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Language.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ResourceProvider.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/AbstractContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/JsonContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/HtmlContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/LanguageDependentTexts.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/AbstractLanguageDependentComponent.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/AbstractHideableLanguageDependentComponent.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/Tab.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/UiStateSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/UiStatePublisher.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/VisibleTabSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/LanguageSelector.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/ProductTableGenerator.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/Actions.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/PictureOverlay.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/LanguageDependentComponent.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/LanguageDependentTextInProductTableSetter.js" charset="UTF-8"></script>
   <script>
      var supportedLanguages  = [shop.Language.DE, shop.Language.EN];
      var configContentLoader = new shop.configuration.JsonContentLoader('http://localhost:8080/configuration', supportedLanguages);
      var htmlContentLoader   = new shop.configuration.HtmlContentLoader('http://localhost:8080/templates', supportedLanguages);
      var languageDependentTexts = new shop.LanguageDependentTexts('http://localhost:8080/configuration');
      
      shop.Context.bus.publish(shop.topics.CURRENT_LANGUAGE, shop.Language.DE);
      shop.Context.defaultVisibleTab = 'start';

      htmlContentLoader.load(['plants_template', 'start_template', 'pictureOverlay_template']);
      configContentLoader.load(['plants', 'accessories']);
      languageDependentTexts.load();
      
      $(document).ready(function() {
      
         new shop.ui.LanguageDependentComponent('#shop > #menu > #start',           'menu.startButton' );
         new shop.ui.LanguageDependentComponent('#shop > #menu > #plants',          'menu.plantsButton' );
         new shop.ui.LanguageDependentComponent('#shop > #menu > #accessories',     'menu.accessoriesButton' );
         new shop.ui.LanguageDependentComponent('#shop > #menu > #shipping',        'menu.shippingButton' );
         new shop.ui.LanguageDependentComponent('#shop > #menu > #companyDetails',  'menu.companyDetailsButton' );
         new shop.ui.LanguageDependentComponent('#shop > #menu > #shoppingCart',    'menu.shoppingCartButton' );
         
         new shop.ui.VisibleTabSetter('#shop > #menu > #start',         'start');
         new shop.ui.VisibleTabSetter('#shop > #menu > #plants',        'plants');
         new shop.ui.VisibleTabSetter('#shop > #menu > #accessories',   'accessories');
         new shop.ui.VisibleTabSetter('#shop > #menu > #shipping',      'shipping');
         
         var startTabConfig = {
            tabId: 'start',
            selector: '#shop > #content > #start',
            configName: undefined,
            contentTemplateName: 'start_template',
            languages: supportedLanguages
         };
         
         var startTab = new shop.ui.Tab(startTabConfig);
         
         var plantTabConfig = {
            tabId: 'plants',
            selector: '#shop > #content > #plants',
            configName: 'plants',
            contentTemplateName: 'plants_template',
            languages: supportedLanguages
         };
         
         var plantTab = new shop.ui.Tab(plantTabConfig);
         
         var setter = new shop.ui.LanguageDependentTextInProductTableSetter();
         plantTab.onTabContentChanged(setter.onTabContentChangedCallback);
         
         var accessoriesTabConfig = {
            tabId: 'accessories',
            selector: '#shop > #content > #accessories',
            configName: 'accessories',
            contentTemplateName: undefined,
            languages: supportedLanguages
         };
         
         var accessoriesTab = new shop.ui.Tab(accessoriesTabConfig);
         
         var pictureOverlayConfig = {
            selector: '#shop > #content > #picture',
            contentTemplateName: 'pictureOverlay_template',
            languages: supportedLanguages
         };
         
         new shop.ui.PictureOverlay(pictureOverlayConfig);
         
         new shop.ui.LanguageSelector(function() { return $('#shop > #menu > #languageSelector'); });
         
         var uiStatePublisher = new shop.ui.UiStatePublisher();
         new shop.ui.UiStateSetter($.uriAnchor.setAnchor);
         
         var onHashChange = function onHashChange() {
            var map = $.uriAnchor.makeAnchorMap();
            uiStatePublisher.setNewState(map);
         };
         
         $(window).bind( 'hashchange', onHashChange ).trigger( 'hashchange' );
      });
   </script>
</head>

<body>
<div id="shop">
   <div id="header">header</div>

   <div id="menu">
      <button id="start"></button> 
      <button id="plants"></button> 
      <button id="accessories"></button> 
      <button id="shipping"></button> 
      <button id="companyDetails"></button> 
      <button id="languageSelector"></button> 
      <button id="shoppingCart"></button> 
   </div>

   <div id="content">
      <div id="start"></div>
      <div id="plants"></div>
      <div id="accessories"></div>
      <div id="picture"></div>
   </div>
   
   <div id="footer">
      <div id="author">written by Thomas Ederer</div>
   </div>
</div>
</body>
</html>  