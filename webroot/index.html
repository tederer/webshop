<!doctype html>
<html>
<head>
   <title>WebShop-SPA</title>
   <link rel="stylesheet" type="text/css" href="css/shop.css">

   <script type="text/javascript" src="lib/jquery-3.2.1.min.js" charset="UTF-8"></script>
   <script type="text/javascript" src="lib/jquery.uriAnchor.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/RequireMock.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/NamespaceUtils.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Promise.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Topics.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/bus/Bus.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Context.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Language.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ResourceProvider.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/AbstractContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/JsonContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/HtmlContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/LanguageDependentTexts.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/AbstractLanguageDependentComponent.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/AbstractTab.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/Tab.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/UiStateSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/VisibleTabPublisher.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/VisibleTabSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/LanguageSelector.js" charset="UTF-8"></script>
   <script>
      var supportedLanguages  = [shop.Language.DE, shop.Language.EN];
      var configContentLoader = new shop.configuration.JsonContentLoader('http://localhost:8080/configuration', supportedLanguages);
      var htmlContentLoader   = new shop.configuration.HtmlContentLoader('http://localhost:8080/templates', supportedLanguages);
      var languageDependentTexts = new shop.LanguageDependentTexts('http://localhost:8080/configuration');
      
      shop.Context.bus.publish(shop.topics.CURRENT_LANGUAGE, shop.Language.DE);
      shop.Context.defaultVisibleTab = 'start';

      htmlContentLoader.load(['pflanzen_template', 'start_template']);
      configContentLoader.load(['pflanzen', 'accessories']);
      languageDependentTexts.load();
      
      $(document).ready(function() {
         var startTabConfig = {
            tabId: 'start',
            selector: '#shop > #content > #start',
            configName: undefined,
            contentTemplateName: 'start_template',
            languages: supportedLanguages
         };
         
         var startTab = new shop.ui.Tab(startTabConfig);
         
         var plantTabConfig = {
            tabId: 'plants',
            selector: '#shop > #content > #plants',
            configName: 'pflanzen',
            contentTemplateName: 'pflanzen_template',
            languages: supportedLanguages
         };
         
         var plantTab = new shop.ui.Tab(plantTabConfig);
         
         var accessoriesTabConfig = {
            tabId: 'accessories',
            selector: '#shop > #content > #accessories',
            configName: 'accessories',
            contentTemplateName: undefined,
            languages: supportedLanguages
         };
         
         var accessoriesTab = new shop.ui.Tab(accessoriesTabConfig);
         
         var languageSelectorConfig = {
            uiComponentProvider:       function() { return $('#shop > #menu > #languageSelector'); },
            languageDependentTextId:   'currentLanguage',
            defaultLanguage:           shop.Language.DE, 
            alternativeLanguage:       shop.Language.EN
         };
         
         new shop.ui.LanguageSelector(languageSelectorConfig);
         
         var visibleTabPublisher = new shop.ui.VisibleTabPublisher();
         new shop.ui.UiStateSetter($.uriAnchor.setAnchor);
         new shop.ui.VisibleTabSetter('#shop > #menu > #start',         'start');
         new shop.ui.VisibleTabSetter('#shop > #menu > #plants',        'plants');
         new shop.ui.VisibleTabSetter('#shop > #menu > #accessories',   'accessories');
         new shop.ui.VisibleTabSetter('#shop > #menu > #shipping',      'shipping');
         
         var onHashChange = function onHashChange() {
            var map = $.uriAnchor.makeAnchorMap();
            visibleTabPublisher.setNewState(map);
         };
         
         $(window).bind( 'hashchange', onHashChange ).trigger( 'hashchange' );
      });
   </script>
</head>

<body>
<div id="shop">

   <div id="header">header</div>

   <div id="menu">
      <button id="start">Start</button> 
      <button id="plants">Pflanzen</button> 
      <button id="accessories">Zubeh√∂r</button> 
      <button id="shipping">Versandbedingungen</button> 
      <button id="languageSelector"></button> 
   </div>

   <div id="content">
      <div id="start"/></div>
      <div id="plants"/></div>
      <div id="accessories"/></div>
   </div>
   
   <div id="footer">
      <div id="author">written by Thomas Ederer</div>
   </div>
</div>
</body>
</html>  