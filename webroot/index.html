<!doctype html>
<html>
<head>
   <title>WebShop-SPA</title>
   <link rel="stylesheet" type="text/css" href="css/shop.css">
   <link rel="stylesheet" type="text/css" href="css/shoppingCartContentTable.css">
   <link rel="stylesheet" type="text/css" href="css/pictureOverlay.css">
   <link rel="stylesheet" type="text/css" href="css/draftOverlay.css">

   <script type="text/javascript" src="lib/webshop_spa.js" charset="UTF-8"></script>
   
   <script type="text/javascript" src="lib/jquery-3.2.1.min.js" charset="UTF-8"></script>
   <script type="text/javascript" src="lib/jquery.uriAnchor.js" charset="UTF-8"></script>
   <!--script type="text/javascript" src="javascripts/RequireMock.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/NamespaceUtils.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Promise.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Topics.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/bus/Bus.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Language.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/Context.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ResourceProvider.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/AbstractContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/JsonContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/HtmlContentLoader.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/LanguageDependentTexts.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ShoppingCart.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/DraftOverlay.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/AbstractLanguageDependentComponent.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/AbstractHideableLanguageDependentComponent.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/UiStateSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/UiStatePublisher.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/SetTabVisibleAction.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/VisibleTabController.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/LanguageSelector.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/AbstractTabContent.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/TabContent.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/Tab.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/tablegenerators/AbstractTableGenerator.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/tablegenerators/ProductsTableGenerator.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/tablegenerators/EventsTableGenerator.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/Actions.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/PictureOverlay.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/LanguageDependentTextSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/tableSetters/LanguageDependentTextInProductsTableSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/tableSetters/LanguageDependentTextInEventsTableSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/ShoppingCartButtonTextSetter.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/ProductConfig.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/TableHeaders.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/InputForm.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/ShoppingCartTexts.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/CostsCalculator.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/CartController.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/TableGenerator.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/EmailTextGenerator.js" charset="UTF-8"></script>
   <script type="text/javascript" src="javascripts/ui/shoppingCart/OrderSubmitter.js" charset="UTF-8"></script-->
   
   <script>
      var baseAddress            = window.location.protocol + '//' + window.location.host + '/';
      var supportedLanguages     = [shop.Language.DE, shop.Language.EN];
      var products               = ['pflanzen', 'zubehoer'];
      var configurations         = ['pflanzen', 'zubehoer', 'termine'];
      var configContentLoader    = new shop.configuration.JsonContentLoader(baseAddress + 'configuration', supportedLanguages);
      var htmlContentLoader      = new shop.configuration.HtmlContentLoader(baseAddress + 'templates', supportedLanguages);
      var languageDependentTexts = new shop.LanguageDependentTexts(baseAddress + 'configuration');
      
      htmlContentLoader.load(['start', 'pflanzen', 'zubehoer', 'termine', 'versandbedingungen', 'impressum', 'warenkorb', 'pictureOverlay']);
      configContentLoader.load(configurations);
      languageDependentTexts.load();
      
      $(document).ready(function() {
         new shop.ShoppingCart();
         
         new shop.ui.LanguageDependentTextSetter('#shop > #header #start',          'menu.startButton' );
         new shop.ui.LanguageDependentTextSetter('#shop > #header #plants',         'menu.plantsButton' );
         new shop.ui.LanguageDependentTextSetter('#shop > #header #accessories',    'menu.accessoriesButton' );
         new shop.ui.LanguageDependentTextSetter('#shop > #header #events',         'menu.events' );
         new shop.ui.LanguageDependentTextSetter('#shop > #header #shipping',       'menu.shippingButton' );
         new shop.ui.LanguageDependentTextSetter('#shop > #header #companyDetails', 'menu.companyDetailsButton' );
         
         new shop.ui.ShoppingCartButtonTextSetter('#shop > #header #shoppingCart',  'menu.shoppingCartButton' );
         
         new shop.ui.SetTabVisibleAction('#shop > #header #start',            'start');
         new shop.ui.SetTabVisibleAction('#shop > #header #plants',           'plants');
         new shop.ui.SetTabVisibleAction('#shop > #header #accessories',      'accessories');
         new shop.ui.SetTabVisibleAction('#shop > #header #events',           'events');
         new shop.ui.SetTabVisibleAction('#shop > #header #shipping',         'shipping');
         new shop.ui.SetTabVisibleAction('#shop > #header #companyDetails',   'companyDetails');
         new shop.ui.SetTabVisibleAction('#shop > #header #shoppingCart',     'shoppingCart');
         
         var startTabConfig = {
            id: 'start',
            selector: '#shop > #content > #start',
            contentSelector: '#shop > #content > #start > #tabContent',
            configName: undefined,
            contentTemplateName: 'start',
            languages: supportedLanguages
         };
         
         var startTab = new shop.ui.Tab(startTabConfig);
         
         var plantTabConfig = {
            id: 'plants',
            selector: '#shop > #content > #plants',
            contentSelector: '#shop > #content > #plants > #tabContent',
            configName: 'pflanzen',
            contentTemplateName: 'pflanzen',
            languages: supportedLanguages
         };
         
         var plantTab = new shop.ui.Tab(plantTabConfig);
         
         var accessoriesTabConfig = {
            id: 'accessories',
            selector: '#shop > #content > #accessories',
            contentSelector: '#shop > #content > #accessories > #tabContent',
            configName: 'zubehoer',
            contentTemplateName: 'zubehoer',
            languages: supportedLanguages
         };
         
         var accessoriesTab = new shop.ui.Tab(accessoriesTabConfig);
         
         var eventsTabConfig = {
            id: 'events',
            selector: '#shop > #content > #events',
            contentSelector: '#shop > #content > #events > #tabContent',
            configName: 'termine',
            contentTemplateName: 'termine',
            languages: supportedLanguages,
            tableGenerator: 'EventsTableGenerator'
         };
         
         var eventsTab = new shop.ui.Tab(eventsTabConfig);
         
         var shippingTabConfig = {
            id: 'shipping',
            selector: '#shop > #content > #shipping',
            contentSelector: '#shop > #content > #shipping > #tabContent',
            configName: undefined,
            contentTemplateName: 'versandbedingungen',
            languages: supportedLanguages
         };
         
         var shippingTab = new shop.ui.Tab(shippingTabConfig);
         
         var companyDetailsTabConfig = {
            id: 'companyDetails',
            selector: '#shop > #content > #companyDetails',
            contentSelector: '#shop > #content > #companyDetails > #tabContent',
            configName: undefined,
            contentTemplateName: 'impressum',
            languages: supportedLanguages
         };
         
         var companyDetailsTab = new shop.ui.Tab(companyDetailsTabConfig);
         
         var shoppingCartTabConfig = {
            id: 'shoppingCart',
            selector: '#shop > #content > #shoppingCart',
            contentSelector: '#shop > #content > #shoppingCart > #tabContent',
            configName: undefined,
            contentTemplateName: 'warenkorb',
            languages: supportedLanguages
         };
         
         var shoppingCartTab = new shop.ui.Tab(shoppingCartTabConfig);
         
         new shop.ui.VisibleTabController([
               startTab, 
               plantTab, 
               accessoriesTab, 
               eventsTab, 
               shippingTab, 
               companyDetailsTab, 
               shoppingCartTab
            ],
            '#shop > #content');
         
         var cartController = new shop.ui.shoppingCart.CartController(products, shoppingCartTab);
         shoppingCartTab.addTabContentChangedListener(cartController.onTabContentChangedCallback);
         
         var plantTableSetter = new shop.ui.tablesetters.LanguageDependentTextInProductsTableSetter('plantsTable');
         var accessoriesTableSetter = new shop.ui.tablesetters.LanguageDependentTextInProductsTableSetter();
         plantTab.addTabContentChangedListener(plantTableSetter.onTabContentChangedCallback);
         accessoriesTab.addTabContentChangedListener(accessoriesTableSetter.onTabContentChangedCallback);
         
         var eventsTableSetter = new shop.ui.tablesetters.LanguageDependentTextInEventsTableSetter();
         eventsTab.addTabContentChangedListener(eventsTableSetter.onTabContentChangedCallback);
         
         var pictureOverlayConfig = {
            selector: '#shop > #picture',
            contentTemplateName: 'pictureOverlay',
            languages: supportedLanguages
         };
         
         new shop.ui.PictureOverlay(pictureOverlayConfig);
         
         new shop.ui.LanguageSelector(function() { return $('#shop > #header #languageSelector'); });
         
         var uiStatePublisherConfig = {
            supportedTabs:       ['start', 'plants', 'accessories', 'events', 'shipping', 'companyDetails', 'shoppingCart'],
            supportedLanguages:  supportedLanguages,
            defaultTab:          'start',
            defaultLanguage:     shop.Language.DE
         };
         var uiStatePublisher = new shop.ui.UiStatePublisher(uiStatePublisherConfig);
         new shop.ui.UiStateSetter($.uriAnchor.setAnchor);
         
         var onHashChange = function onHashChange() {
            var map = $.uriAnchor.makeAnchorMap();
            uiStatePublisher.setNewState(map);
         };
         
         $(window).bind( 'hashchange', onHashChange ).trigger( 'hashchange' );
         
         shop.ui.DraftOverlay.init();
      });
   </script>
</head>

<body>
<div id="draftOverlay">
   <table class="fullscreenTable">
      <tr>
         <td>
         
            <table>
               <tr>
                  <td colspan="2" class="caption"><h1>Test / Draft</h1></td>
               </tr>
               <tr>
                  <td><p>Passwort:</p></td>
                  <td><input id="passwordTextField" value="" size="40" type="password"></td>
               </tr>
               <tr>
                  <td colspan="2" class="buttonRow"><button type="button" id="draftOverlayButton" onclick="shop.ui.DraftOverlay.passwordEntered()">Fortsetzen</button></td>
               </tr>
            </table>
            
         </td>
      </tr>
   </table>   
</div>

<div id="shop">

   <div id="header">
      <table>
         <tr class="firstRow">
            <td rowspan="2" class="leftColumn">
               <img src="/images/logo.svg">
            </td>
            <td class="centerColumn">
               <h1>Orchideenvermehrung Ederer Webshop</h1>
            </td>
            <td class="rightColumn">
               <button id="languageSelector"></button> 
            </td>
         </tr>
         <tr class="secondRow">
            <td class="centerColumn">
               <button id="start"></button> 
               <button id="plants"></button> 
               <button id="accessories"></button> 
               <button id="events"></button> 
               <button id="shipping"></button> 
               <button id="companyDetails"></button> 
            </td>
            <td class="rightColumn">
               <button id="shoppingCart"></button> 
            </td>
         </tr>
      </table>
   </div>

   <div id="content">
      <div class="tab" id="start">
         <div id="tabContent"></div>
         <div id="footer">written by Thomas Ederer</div>
      </div>
      <div class="tab" id="plants">
         <div id="tabContent"></div>
         <div id="footer">written by Thomas Ederer</div>
      </div>
      <div class="tab" id="accessories">
         <div id="tabContent"></div>
         <div id="footer">written by Thomas Ederer</div>
      </div>
      <div class="tab" id="events">
         <div id="tabContent"></div>
         <div id="footer">written by Thomas Ederer</div>
      </div>
      <div class="tab" id="shipping">
         <div id="tabContent"></div>
         <div id="footer">written by Thomas Ederer</div>
      </div>
      <div class="tab" id="companyDetails">
         <div id="tabContent"></div>
         <div id="footer">written by Thomas Ederer</div>
      </div>
      <div class="tab" id="shoppingCart">
         <div id="tabContent"></div>
         <div id="footer">written by Thomas Ederer</div>
      </div>
   </div>
   
   <div id="picture"></div>
</div>
</body>
</html>  